<!DOCTYPE html><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta name="theme-color" content="#1a1a1a"><meta name="msapplication-navbutton-color" content="#1a1a1a"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><title>Between's Blog</title><script>(function() {
  // å°½æ—©åº”ç”¨æš—è‰²æ¨¡å¼ï¼Œé˜²æ­¢é—ªçƒ
  var savedDarkMode = localStorage.getItem('darkMode') === 'true';
  if (savedDarkMode) {
    document.documentElement.classList.add('dark-mode');
  }
})();
</script><link rel="preconnect" href="https://fonts.googleapis.com"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&amp;family=Playfair+Display:wght@400;500;600;700&amp;family=Fira+Code:wght@400;500&amp;display=swap" rel="stylesheet"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"><script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script><link rel="icon" href="/images/wumai.ico">
<link rel="stylesheet" href="/css/main.css">

<link rel="stylesheet" href="/css/tags.css">

<link rel="stylesheet" href="/css/categories.css">

<link rel="stylesheet" href="/css/categories-accordion.css">

<link rel="stylesheet" href="/css/highlight.css">

<link rel="stylesheet" href="/css/toc.css">

<link rel="stylesheet" href="/css/image-zoom.css">

<link rel="stylesheet" href="/css/share.css">

<link rel="stylesheet" href="/css/mobile-nav.css">

<link rel="stylesheet" href="/css/search.css">

<link rel="stylesheet" href="/css/scrollbar.css">

<link rel="stylesheet" href="/css/timeline.css">

<link rel="stylesheet" href="/css/animations.css">

<link rel="stylesheet" href="/css/ai-theme.css">

<link rel="stylesheet" href="/css/loading-animation.css">

<link rel="stylesheet" href="/css/code-mermaid-fold.css">

<link rel="stylesheet" href="/css/mermaid-magnifier.css">
<!-- æ¡ä»¶åŠ è½½å…³äºé¡µé¢æ ·å¼--><style>:root {
  --primary-color: #1a1a1a;
  --secondary-color: #666666;
  --accent-color: #ff6b6b;
  --background-color: #ffffff;
  --text-color: #333333;
  --overlay-color: rgba(0, 0, 0, 0.7);
  --tag-background-color: #ffffff;
  --card-background-color: #ffffff;
}
</style><link rel="stylesheet" href="https://cdn1.tianli0.top/gh/qxchuckle/Post-Summary-AI/chuckle-post-ai.css"><meta name="generator" content="Hexo 8.1.1"></head><body><div id="app"><header class="header navbar-bubble"><nav class="nav"><div class="nav-container"><div class="nav-logo"><a href="/"><span class="nav-title">Between's Blog</span></a></div><div class="nav-menu"><a class="nav-item" href="/">é¦–é¡µ</a><a class="nav-item" href="/about/">å…³äº</a><a class="nav-item" href="/archives/">å½’æ¡£</a><a class="nav-item" href="/categories/">åˆ†ç±»</a><a class="nav-item" href="/tags/">æ ‡ç­¾</a><div class="nav-item has-submenu"><span class="nav-link">ç½‘ç«™</span><div class="submenu"><a class="submenu-item" target="_blank" rel="noopener" href="https://example.com">ç¤ºä¾‹ç½‘ç«™</a></div></div><!-- æœç´¢æŒ‰é’®--><div class="search-toggle"><i class="fas fa-search"></i></div><!-- å¤œé—´æ¨¡å¼åˆ‡æ¢æŒ‰é’®--><div class="dark-mode-toggle"><i class="fas fa-moon"></i></div></div><div class="nav-toggle"><span></span><span></span><span></span></div></div></nav></header><div class="search-overlay"><div class="search-container"><div class="search-form"><input class="search-input" type="text" placeholder="æœç´¢æ–‡ç« ..."/><div class="search-close">Ã—</div></div><div class="search-results"></div></div></div><main class="main"><div class="post-wrapper"><div class="toc-sidebar"><div class="toc-container"><div class="toc-title">ç›®å½•</div><div class="toc-content" id="table-of-contents"><!-- Table of contents will be generated by JavaScript--></div></div></div><article class="post-container"><div class="post-header"><div class="post-cover"><img src="https://images.weserv.nl/?url=http://www.ygotoken.com/images/webp/17056.webp" alt="Animatorä¸Animationåº•å±‚å®ç°å‰–æ"/></div><div class="post-meta"><div class="post-category"><a href="/categories/unity/">unity</a></div><div class="post-date"><time datetime="2026-01-09T09:06:47.000Z">January 09, 2026</time></div><div class="post-author"><span>By Between</span></div></div><h1 class="post-title">Animatorä¸Animationåº•å±‚å®ç°å‰–æ</h1><div class="post-tags"><a class="tag" href="/tags/unity/">unity</a><a class="tag" href="/tags/animation/">animation</a></div></div><!-- AIæ‘˜è¦æ¨¡å—å®¹å™¨--><div id="post-ai-container"></div><!-- å¯†ç ä¿æŠ¤åŠŸèƒ½--><div class="password-protect" data-password="135246"><div class="password-overlay"><div class="password-box"><h3>ğŸ”’ æ­¤æ–‡ç« å—å¯†ç ä¿æŠ¤</h3><p>è¯·è¾“å…¥å¯†ç æŸ¥çœ‹å†…å®¹</p><input class="password-input" type="password" placeholder="è¯·è¾“å…¥å¯†ç "/><button class="password-submit">è§£é”</button><div class="password-error" style="display: none; color: #ff6b6b; margin-top: 10px;"></div></div></div></div><div class="post-content"><h1 id="æ ¸å¿ƒç»„ä»¶åŸç†ï¼šAnimator-ä¸-Animation-åº•å±‚å®ç°å‰–æ"><a href="#æ ¸å¿ƒç»„ä»¶åŸç†ï¼šAnimator-ä¸-Animation-åº•å±‚å®ç°å‰–æ" class="headerlink" title="æ ¸å¿ƒç»„ä»¶åŸç†ï¼šAnimator ä¸ Animation åº•å±‚å®ç°å‰–æ"></a>æ ¸å¿ƒç»„ä»¶åŸç†ï¼šAnimator ä¸ Animation åº•å±‚å®ç°å‰–æ</h1><p>åœ¨ Unity çš„åŠ¨ç”»ä½“ç³»ä¸­ï¼Œ<code>Animation</code>ï¼ˆLegacyï¼‰ä¸ <code>Animator</code>ï¼ˆMecanimï¼‰å¹¶éç®€å•çš„è¿­ä»£æ›¿ä»£å…³ç³»ï¼Œè€Œæ˜¯ä¸¤å¥—åŸºäºä¸åŒè®¾è®¡ç†å¿µçš„åº•å±‚æ¶æ„ã€‚å‰è€…ä¾§é‡äº<strong>ç›´æ¥çš„æ•°æ®é©±åŠ¨</strong>ï¼Œåè€…ä¾§é‡äº<strong>åŸºäºçŠ¶æ€æœºçš„é‡å®šå‘è®¡ç®—</strong>ã€‚æœ¬æ–‡å°†å‰¥ç¦»ä¸Šå±‚ UIï¼Œä»åº•å±‚å·¥ä½œæµã€å†…å­˜æ¨¡å‹åŠæ‰§è¡Œé€»è¾‘ç»´åº¦ï¼Œæ·±åº¦æ‹†è§£è¿™ä¸¤å¤§æ ¸å¿ƒç»„ä»¶çš„è¿è¡Œæœºåˆ¶ã€‚</p>
<h2 id="ä¸€ã€Animation-ç»„ä»¶ï¼šçº¿æ€§é‡‡æ ·çš„ç›´æ¥é©±åŠ¨è€…"><a href="#ä¸€ã€Animation-ç»„ä»¶ï¼šçº¿æ€§é‡‡æ ·çš„ç›´æ¥é©±åŠ¨è€…" class="headerlink" title="ä¸€ã€Animation ç»„ä»¶ï¼šçº¿æ€§é‡‡æ ·çš„ç›´æ¥é©±åŠ¨è€…"></a>ä¸€ã€Animation ç»„ä»¶ï¼šçº¿æ€§é‡‡æ ·çš„ç›´æ¥é©±åŠ¨è€…</h2><p><code>Animation</code> ç»„ä»¶ï¼ˆLegacy Systemï¼‰æ˜¯ Unity æ—©æœŸåŠ¨ç”»ç³»ç»Ÿçš„æ ¸å¿ƒã€‚å…¶åº•å±‚è®¾è®¡å“²å­¦æ˜¯â€œ<strong>æ‰€è§å³æ‰€å¾—çš„æ›²çº¿æ˜ å°„</strong>â€ã€‚å®ƒä¸åŒ…å«çŠ¶æ€æœºé€»è¾‘ï¼Œæœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªæ’­æ”¾å’Œæ··åˆåŠ¨ç”»æ›²çº¿ï¼ˆAnimation Curveï¼‰çš„é‡‡æ ·å™¨ã€‚</p>
<h3 id="1-1-å¸§æ’­æ”¾ä¸é‡‡æ ·æœºåˆ¶"><a href="#1-1-å¸§æ’­æ”¾ä¸é‡‡æ ·æœºåˆ¶" class="headerlink" title="1.1 å¸§æ’­æ”¾ä¸é‡‡æ ·æœºåˆ¶"></a>1.1 å¸§æ’­æ”¾ä¸é‡‡æ ·æœºåˆ¶</h3><p>Animation çš„æ ¸å¿ƒå·¥ä½œæµæ˜¯ä¸€ä¸ªçº¿æ€§å¾ªç¯ï¼š<code>Time Update</code> â†’ <code>Sample Curve</code> â†’ <code>Apply Transform</code>ã€‚</p>
<ul>
<li><strong>æ—¶åºç§¯åˆ†ä¸ PlayerLoop</strong>ï¼š<br>  Animation ç»„ä»¶é»˜è®¤åœ¨ <code>Update</code> é˜¶æ®µæ‰§è¡Œã€‚ç³»ç»Ÿæ ¹æ® <code>Time.deltaTime * speed</code> æ›´æ–°å½“å‰åŠ¨ç”»çŠ¶æ€çš„ <code>normalizedTime</code>ã€‚<ul>
<li><em>æ€§èƒ½ç“¶é¢ˆ</em>ï¼šå…¶é‡‡æ ·è¿‡ç¨‹æ˜¯<strong>ä¸²è¡Œ</strong>çš„ï¼ˆSerial Processingï¼‰ã€‚å¦‚æœåŒä¸€å¸§æœ‰ 500 ä¸ª Animation ç»„ä»¶åœ¨è¿è¡Œï¼Œå®ƒä»¬ä¼šä¾æ¬¡å ç”¨ä¸»çº¿ç¨‹æ—¶é—´ï¼Œç›´æ¥æ‹–æ…¢æ¸¸æˆå¸§ç‡ã€‚</li>
</ul>
</li>
<li><strong>é‡‡æ ·é€»è¾‘ (Sampling)</strong>ï¼š<br>  ç³»ç»Ÿæ ¹æ®å½“å‰æ—¶é—´æˆ³ï¼Œåœ¨ <code>AnimationClip</code> çš„æ›²çº¿æ•°æ®ä¸­æŸ¥æ‰¾ç›¸é‚»çš„ä¸¤ä¸ªå…³é”®å¸§ï¼ˆKeyframeï¼‰ã€‚<ul>
<li><strong>æ’å€¼ç®—æ³•</strong>ï¼šUnity é»˜è®¤ä½¿ç”¨ <strong>Hermite æ ·æ¡æ’å€¼</strong>è®¡ç®—ä¸¤ä¸ªå…³é”®å¸§ä¹‹é—´çš„ç¡®åˆ‡å€¼ã€‚</li>
<li><strong>ç›´æ¥æ˜ å°„</strong>ï¼šè®¡ç®—å‡ºçš„ float å€¼ä¼š<strong>ç›´æ¥</strong>å†™å…¥ç›®æ ‡å¯¹è±¡çš„ Transformï¼ˆLocalPosition&#x2F;Rotation&#x2F;Scaleï¼‰ã€‚ä¸­é—´æ²¡æœ‰é‡å®šå‘ï¼ˆRetargetingï¼‰å±‚ï¼Œè·¯å¾„æ˜¯ç¡¬ç¼–ç çš„å­—ç¬¦ä¸²ï¼ˆå¦‚ <code>&quot;Root/Hips/Spine&quot;</code>ï¼‰ã€‚</li>
</ul>
</li>
</ul>
<h3 id="1-2-CrossFade-æ··åˆåŸç†ï¼šåŸºäºæƒé‡çš„ç´¯åŠ "><a href="#1-2-CrossFade-æ··åˆåŸç†ï¼šåŸºäºæƒé‡çš„ç´¯åŠ " class="headerlink" title="1.2 CrossFade æ··åˆåŸç†ï¼šåŸºäºæƒé‡çš„ç´¯åŠ "></a>1.2 CrossFade æ··åˆåŸç†ï¼šåŸºäºæƒé‡çš„ç´¯åŠ </h3><p><code>Animation.CrossFade</code> çš„åº•å±‚å¹¶éçœŸçš„ç”Ÿæˆäº†æ–°çš„ä¸­é—´å¸§ï¼Œè€Œæ˜¯åŸºäº**æ··åˆæƒé‡ï¼ˆBlend Weightï¼‰**çš„åŠ æƒå¹³å‡ã€‚</p>
<ul>
<li><strong>è½¨é“ï¼ˆTrackï¼‰æ¦‚å¿µ</strong>ï¼šAnimation ç»„ä»¶ç»´æŠ¤ç€ä¸€ä¸ªæ´»è·ƒçš„åŠ¨ç”»çŠ¶æ€åˆ—è¡¨ï¼ˆActive Animation Statesï¼‰ã€‚</li>
<li><strong>æ··åˆç®—æ³•</strong>ï¼š<br>  å½“è°ƒç”¨ CrossFade æ—¶ï¼Œæ—§åŠ¨ç”»çš„æƒé‡åœ¨ <code>fadeLength</code> æ—¶é—´å†…ä» 1.0 é™è‡³ 0.0ï¼Œæ–°åŠ¨ç”»æƒé‡ä» 0.0 å‡è‡³ 1.0ã€‚æœ€ç»ˆçš„å˜æ¢ç»“æœæ˜¯æ‰€æœ‰æ´»è·ƒçŠ¶æ€çš„åŠ æƒå’Œï¼š<br>  $$FinalTransform &#x3D; \frac{\sum (Transform_i \times Weight_i)}{\sum Weight_i}$$<ul>
<li><em>æ€§èƒ½éšæ‚£</em>ï¼šå¦‚æœåœ¨ CrossFade æœŸé—´é¢‘ç¹è§¦å‘æ–°çš„ CrossFadeï¼Œä¼šå¯¼è‡´åˆ—è¡¨ä¸­åŒæ—¶å­˜åœ¨å¤šä¸ªæ´»è·ƒåŠ¨ç”»ï¼ˆå¦‚ 3-4 ä¸ªåŠ¨ç”»åŒæ—¶è®¡ç®—ï¼‰ï¼Œå¯¼è‡´å•å¸§é‡‡æ ·å¼€é”€æˆå€å¢åŠ ã€‚</li>
</ul>
</li>
</ul>
<hr>
<h2 id="äºŒã€Animator-ç»„ä»¶ï¼šå›¾é©±åŠ¨çš„é‡å®šå‘å¼•æ“"><a href="#äºŒã€Animator-ç»„ä»¶ï¼šå›¾é©±åŠ¨çš„é‡å®šå‘å¼•æ“" class="headerlink" title="äºŒã€Animator ç»„ä»¶ï¼šå›¾é©±åŠ¨çš„é‡å®šå‘å¼•æ“"></a>äºŒã€Animator ç»„ä»¶ï¼šå›¾é©±åŠ¨çš„é‡å®šå‘å¼•æ“</h2><p><code>Animator</code> ç»„ä»¶æ˜¯ç°ä»£ Unity åŠ¨ç”»ç³»ç»Ÿçš„å…¥å£ï¼Œå…¶åº•å±‚æ¥å…¥äº† C++ å±‚é¢çš„ <strong>Evaluation Graphï¼ˆè¯„ä¼°å›¾ï¼‰</strong> å’Œ <strong>Job System</strong>ã€‚å®ƒçš„æ ¸å¿ƒä¸ä»…ä»…æ˜¯æ’­æ”¾åŠ¨ç”»ï¼Œè€Œæ˜¯â€œç¿»è¯‘â€åŠ¨ç”»ã€‚</p>
<h3 id="2-1-æ ¸å¿ƒå·¥ä½œæµï¼šä»èµ„æºåˆ°éª¨éª¼"><a href="#2-1-æ ¸å¿ƒå·¥ä½œæµï¼šä»èµ„æºåˆ°éª¨éª¼" class="headerlink" title="2.1 æ ¸å¿ƒå·¥ä½œæµï¼šä»èµ„æºåˆ°éª¨éª¼"></a>2.1 æ ¸å¿ƒå·¥ä½œæµï¼šä»èµ„æºåˆ°éª¨éª¼</h3><p>Animator çš„ä¸€å¸§åŒ…å«å››ä¸ªå…³é”®é˜¶æ®µï¼š</p>
<ol>
<li><p><strong>Controller åŠ è½½ä¸å›¾æ„å»º (Graph Construction)</strong>ï¼š<br>å½“ <code>Animator</code> åˆå§‹åŒ–æ—¶ï¼Œå®ƒä¼šè¯»å– <code>AnimatorController</code> èµ„æºï¼Œåœ¨å†…å­˜ä¸­å®ä¾‹åŒ–ä¸€ä¸ªè¿è¡Œæ—¶çŠ¶æ€æœºå›¾ï¼ˆRuntime State Machine Graphï¼‰ã€‚</p>
<ul>
<li><em>GC é£é™©</em>ï¼šè¿™æ˜¯äº§ç”Ÿ GC Alloc å’Œå®ä¾‹åŒ–å¡é¡¿çš„ä¸»è¦é˜¶æ®µã€‚</li>
</ul>
</li>
<li><p><strong>çŠ¶æ€æœºé€»è¾‘æ±‚å€¼ (State Machine Evaluation)</strong>ï¼š</p>
<ul>
<li><strong>è¾“å…¥</strong>ï¼šå‚æ•°ï¼ˆSetBool&#x2F;SetFloatï¼‰ã€‚</li>
<li><strong>å¤„ç†</strong>ï¼šè®¡ç®— Transition æ¡ä»¶ï¼Œæ›´æ–°å½“å‰æ¿€æ´»çš„ State å’Œ BlendTree æƒé‡ã€‚</li>
<li><strong>è¾“å‡º</strong>ï¼šç”Ÿæˆä¸€ä»½â€œåŠ¨ç”»ä»»åŠ¡æ¸…å•â€ï¼ˆä¾‹å¦‚ï¼šæ’­æ”¾ Clip A çš„ 0.5 ç§’ï¼Œæƒé‡ 0.8ï¼›Clip B çš„ 0.2 ç§’ï¼Œæƒé‡ 0.2ï¼‰ã€‚</li>
</ul>
</li>
<li><p><strong>åŠ¨ç”»ä½œä¸šè®¡ç®— (Animation Job Evaluation)</strong>ï¼š<br>ç³»ç»Ÿåˆ©ç”¨ <strong>Worker Threads</strong> å¹¶è¡Œå¤„ç†ä»»åŠ¡æ¸…å•ã€‚</p>
<ul>
<li><strong>é‡‡æ ·ä¸æ··åˆ</strong>ï¼šä¸ Animation ç±»ä¼¼ï¼Œä½†å¹¶è¡ŒåŒ–æ‰§è¡Œã€‚</li>
<li><strong>Avatar é‡å®šå‘ (Retargeting)</strong>ï¼šè¿™æ˜¯æœ€è€—æ—¶çš„æ­¥éª¤ã€‚ç³»ç»Ÿå°†é‡‡æ ·å¾—åˆ°çš„â€œæºéª¨éª¼æ•°æ®â€ï¼ˆSource Skeletonï¼‰æ˜ å°„åˆ°â€œç›®æ ‡ Avatar éª¨éª¼â€ï¼ˆTarget Avatarï¼‰ã€‚è¿™å…è®¸ä¸€ä¸ªäººå½¢åŠ¨ç”»åœ¨ä¸åŒä½“å‹çš„æ¨¡å‹ä¸Šé€šç”¨ï¼Œä½†å¼•å…¥äº†é¢å¤–çš„çŸ©é˜µè®¡ç®—å¼€é”€ã€‚</li>
</ul>
</li>
<li><p><strong>éª¨éª¼æ•°æ®å›å†™ (Write Output)</strong>ï¼š<br>è®¡ç®—å®Œæˆçš„ Transform çŸ©é˜µè¢«å†™å›åœºæ™¯ä¸­çš„ Transform ç»„ä»¶ï¼Œæˆ–ä¼ é€’ç»™ SkinnedMeshRenderer è¿›è¡Œè’™çš®æ¸²æŸ“ã€‚</p>
</li>
</ol>
<h3 id="2-2-æ ¸å¿ƒæµç¨‹å›¾è§£"><a href="#2-2-æ ¸å¿ƒæµç¨‹å›¾è§£" class="headerlink" title="2.2 æ ¸å¿ƒæµç¨‹å›¾è§£"></a>2.2 æ ¸å¿ƒæµç¨‹å›¾è§£</h3><pre class="mermaid">graph LR
    A[Update Loop] --> B{Culling Check}
    B -- Visible --> C[State Machine Logic]
    C --> D[Job System Eval]
    D --> E[Avatar Retargeting]
    E --> F[Apply to Transform]
    B -- Culled --> G[Skip Eval]</pre>

<h3 id="2-3-å…³é”®ä¼˜åŒ–æœºåˆ¶ï¼šCulling-Mode"><a href="#2-3-å…³é”®ä¼˜åŒ–æœºåˆ¶ï¼šCulling-Mode" class="headerlink" title="2.3 å…³é”®ä¼˜åŒ–æœºåˆ¶ï¼šCulling Mode"></a>2.3 å…³é”®ä¼˜åŒ–æœºåˆ¶ï¼šCulling Mode</h3><p>Animator çš„æ€§èƒ½å¾ˆå¤§ç¨‹åº¦ä¸Šå–å†³äº <code>CullingMode</code> çš„è®¾ç½®ï¼š</p>
<ul>
<li><strong>AlwaysAnimate</strong>: å§‹ç»ˆæ‰§è¡Œé€»è¾‘ã€é‡å®šå‘å’Œè’™çš®ã€‚å“ªæ€•åœ¨å±å¹•å¤–ã€‚</li>
<li><strong>CullUpdateTransforms</strong>: å½“ä¸å¯è§æ—¶ï¼Œ<strong>åœæ­¢å†™å…¥éª¨éª¼ï¼ˆRetargeting &amp; Writeï¼‰</strong>ï¼Œä½†**ä¿ç•™çŠ¶æ€æœºé€»è¾‘ï¼ˆLogicï¼‰**è¿è¡Œã€‚è¿™æ˜¯å¤§å¤šæ•°æƒ…å†µçš„æœ€ä½³é€‰æ‹©ï¼ˆä½ç½®åŒæ­¥ï¼Œä½†ä¸æ¸²æŸ“ï¼‰ã€‚</li>
<li><strong>CullCompletely</strong>: å½“ä¸å¯è§æ—¶ï¼Œå®Œå…¨åœæ­¢æ‰€æœ‰è®¡ç®—ã€‚å†æ¬¡å¯è§æ—¶å¯èƒ½ä¼šæœ‰â€œåŠ¨ç”»ç¬ç§»â€ç°è±¡ã€‚</li>
</ul>
<hr>
<h2 id="ä¸‰ã€ç»„ä»¶åº•å±‚å·®å¼‚å¯¹æ¯”"><a href="#ä¸‰ã€ç»„ä»¶åº•å±‚å·®å¼‚å¯¹æ¯”" class="headerlink" title="ä¸‰ã€ç»„ä»¶åº•å±‚å·®å¼‚å¯¹æ¯”"></a>ä¸‰ã€ç»„ä»¶åº•å±‚å·®å¼‚å¯¹æ¯”</h2><table>
<thead>
<tr>
<th align="left">ç»´åº¦</th>
<th align="left">Animation (Legacy)</th>
<th align="left">Animator (Modern)</th>
</tr>
</thead>
<tbody><tr>
<td align="left"><strong>æ•°æ®æµå‘</strong></td>
<td align="left"><strong>Curve â†’ Transform</strong><br>ç›´æ¥å†™å…¥ï¼Œä¾é  Transform è·¯å¾„æŸ¥æ‰¾ã€‚</td>
<td align="left"><strong>State â†’ Graph â†’ Retarget â†’ Transform</strong><br>é€šè¿‡ Avatar æ˜ å°„ï¼Œè§£è€¦éª¨éª¼å±‚çº§ã€‚</td>
</tr>
<tr>
<td align="left"><strong>æ›´æ–°æ—¶æœº</strong></td>
<td align="left"><strong>Update (Main Thread)</strong><br>å¼ºä¾èµ–ä¸»çº¿ç¨‹ï¼Œä¸²è¡Œæ‰§è¡Œã€‚</td>
<td align="left"><strong>PreLateUpdate (Worker Threads)</strong><br>é€»è¾‘åœ¨ä¸»çº¿ç¨‹ï¼Œç¹é‡çš„è®¡ç®—åœ¨å­çº¿ç¨‹ã€‚</td>
</tr>
<tr>
<td align="left"><strong>Retargeting</strong></td>
<td align="left"><strong>æ—  (None)</strong><br>é€Ÿåº¦å¿«ï¼Œä½†åŠ¨ç”»ä¸å¯å¤ç”¨ã€‚</td>
<td align="left"><strong>æœ‰ (High Cost)</strong><br>é€šç”¨æ€§å¼ºï¼Œä½†æœ‰äººå½¢é‡å®šå‘å¼€é”€ã€‚</td>
</tr>
<tr>
<td align="left"><strong>å†…å­˜æ¨¡å‹</strong></td>
<td align="left"><strong>è½»é‡çº§</strong><br>ä»…å­˜å‚¨å½“å‰ Clip çš„é‡‡æ ·çŠ¶æ€å…‰æ ‡ã€‚</td>
<td align="left"><strong>é‡é‡çº§</strong><br>éœ€ç»´æŠ¤çŠ¶æ€æœºå›¾ã€Avatar æ˜ å°„è¡¨ã€æ··åˆç¼“å†²ï¼ˆBlend Bufferï¼‰ã€‚</td>
</tr>
<tr>
<td align="left"><strong>ç‰©ç†äº¤äº’</strong></td>
<td align="left">éœ€æ‰‹åŠ¨åœ¨ FixedUpdate å¤„ç†æˆ–å®¹å¿æŠ–åŠ¨ã€‚</td>
<td align="left">åŸç”Ÿæ”¯æŒ <code>Animate Physics</code> æ¨¡å¼ï¼Œè‡ªåŠ¨å°†æ›´æ–°æ—¶æœºæ³¨å…¥åˆ° FixedUpdate å¾ªç¯ã€‚</td>
</tr>
</tbody></table>
<h3 id="3-1-é€‚ç”¨åœºæ™¯çš„æŠ€æœ¯åˆ¤å®š"><a href="#3-1-é€‚ç”¨åœºæ™¯çš„æŠ€æœ¯åˆ¤å®š" class="headerlink" title="3.1 é€‚ç”¨åœºæ™¯çš„æŠ€æœ¯åˆ¤å®š"></a>3.1 é€‚ç”¨åœºæ™¯çš„æŠ€æœ¯åˆ¤å®š</h3><ul>
<li><strong>é€‰ç”¨ Animation</strong>ï¼š<ul>
<li>å¯¹è±¡ä¸éœ€è¦é‡å®šå‘ï¼ˆå¦‚ UI åŠ¨ç”»ã€ç®€å•çš„æœºæ¢°è£…ç½®ã€æ­¦å™¨éƒ¨ä»¶ï¼‰ã€‚</li>
<li>ä¸éœ€è¦å¤æ‚çš„çŠ¶æ€æ··åˆé€»è¾‘ã€‚</li>
<li>å¯¹å†…å­˜æå…¶æ•æ„Ÿçš„ä½ç«¯æœºæµ·é‡ç‰©ä½“ï¼ˆå¦‚ 1000 ä¸ªç®€å•çš„é‡‘å¸æ—‹è½¬ï¼‰ã€‚</li>
</ul>
</li>
<li><strong>é€‰ç”¨ Animator</strong>ï¼š<ul>
<li>äººå½¢è§’è‰²ï¼ˆHumanoidï¼‰ï¼Œå¿…é¡»å¤ç”¨åŠ¨ç”»ã€‚</li>
<li>éœ€è¦ä½¿ç”¨ BlendTree è¿›è¡Œå¤šç»´æ··åˆï¼ˆå¦‚ 2D è¿åŠ¨æ··åˆï¼‰ã€‚</li>
<li>éœ€è¦åˆ©ç”¨ Job System è¿›è¡Œå¤šçº¿ç¨‹ä¼˜åŒ–çš„é«˜é¢‘è§’è‰²ã€‚</li>
</ul>
</li>
</ul>
<hr>
<h2 id="å››ã€å›¢ç»“å¼•æ“-Tuanjie-çš„å…¬å¼€ä¼˜åŒ–"><a href="#å››ã€å›¢ç»“å¼•æ“-Tuanjie-çš„å…¬å¼€ä¼˜åŒ–" class="headerlink" title="å››ã€å›¢ç»“å¼•æ“ (Tuanjie) çš„å…¬å¼€ä¼˜åŒ–"></a>å››ã€å›¢ç»“å¼•æ“ (Tuanjie) çš„å…¬å¼€ä¼˜åŒ–</h2><p>å›¢ç»“å¼•æ“é’ˆå¯¹å›½å†…ç§»åŠ¨ç«¯ç”Ÿæ€ï¼ˆå°¤å…¶æ˜¯å°æ¸¸æˆå’Œä¸­ä½ç«¯å®‰å“è®¾å¤‡ï¼‰ï¼Œåœ¨åº•å±‚å¯¹åŠ¨ç”»ç»„ä»¶è¿›è¡Œäº†é’ˆå¯¹æ€§ä¼˜åŒ–ã€‚</p>
<h3 id="4-1-ç»„ä»¶å®ä¾‹åŒ–æ•ˆç‡"><a href="#4-1-ç»„ä»¶å®ä¾‹åŒ–æ•ˆç‡" class="headerlink" title="4.1 ç»„ä»¶å®ä¾‹åŒ–æ•ˆç‡"></a>4.1 ç»„ä»¶å®ä¾‹åŒ–æ•ˆç‡</h3><p>åŸç‰ˆ Unity åœ¨å®ä¾‹åŒ–å«æœ‰å¤æ‚ <code>AnimatorController</code> çš„ Prefab æ—¶ï¼Œä¼šè§¦å‘æ˜‚è´µçš„ <code>Animator.Initialize</code>ï¼Œæ¶‰åŠå¤§é‡ C++ å¯¹è±¡çš„å†…å­˜åˆ†é…ã€‚</p>
<ul>
<li><strong>Tuanjie ä¼˜åŒ–</strong>ï¼šå¼•å…¥äº† <strong>Runtime Animator Controller çš„è½»é‡åŒ–å®ä¾‹</strong>ã€‚å¯¹äºç›¸åŒçš„ Controllerï¼Œå¼•æ“åº•å±‚å…±äº«äº†æ›´å¤šçš„åªè¯»æ•°æ®ï¼ˆRead-Only Graph Dataï¼‰ï¼Œä»…ä¸ºæ¯ä¸ªå®ä¾‹åˆ†é…å¿…è¦çš„çŠ¶æ€æ•°æ®ï¼ˆState Dataï¼‰ã€‚</li>
<li><strong>æ•ˆæœ</strong>ï¼šæ˜¾è‘—é™ä½äº†å¤§é‡æ€ªç‰©ç”Ÿæˆæ—¶çš„ CPU å³°å€¼ï¼ˆSpikeï¼‰ï¼Œå†…å­˜å ç”¨é™ä½çº¦ 15%-20%ã€‚</li>
</ul>
<h3 id="4-2-å…¼å®¹æ€§ä¸ä½é…ä¼˜åŒ–"><a href="#4-2-å…¼å®¹æ€§ä¸ä½é…ä¼˜åŒ–" class="headerlink" title="4.2 å…¼å®¹æ€§ä¸ä½é…ä¼˜åŒ–"></a>4.2 å…¼å®¹æ€§ä¸ä½é…ä¼˜åŒ–</h3><ul>
<li><p><strong>å„å‘å¼‚æ€§å‰”é™¤ (Aggressive Culling)</strong>ï¼š<br>  å›¢ç»“å¼•æ“å¢å¼ºäº† <code>CullUpdateTransforms</code> çš„é€»è¾‘ã€‚åœ¨æ£€æµ‹åˆ°è®¾å¤‡ç®—åŠ›ä¸è¶³ï¼ˆLow Tier Deviceï¼‰æ—¶ï¼Œä¼šè‡ªåŠ¨é™ä½ç¦»å±æˆ–è¿œè·ç¦» Animator çš„æ›´æ–°é¢‘ç‡ï¼ˆä¾‹å¦‚æ¯ 2 å¸§æ›´æ–°ä¸€æ¬¡é€»è¾‘ï¼Œæ¯ 4 å¸§æ›´æ–°ä¸€æ¬¡éª¨éª¼ï¼‰ï¼Œè€Œæ— éœ€å¼€å‘è€…æ‰‹åŠ¨ç¼–å†™ LOD è„šæœ¬ã€‚</p>
</li>
<li><p><strong>WebGL&#x2F;å°æ¸¸æˆé€‚é…</strong>ï¼š<br>  é’ˆå¯¹å¾®ä¿¡å°æ¸¸æˆç¯å¢ƒï¼Œå»é™¤äº† Animator ä¸­ä¸å¸¸ç”¨çš„å½±è§†çº§åŠŸèƒ½ï¼ˆå¦‚ Motion Vectors ç”Ÿæˆã€å¤æ‚çš„ IK Passï¼‰ï¼Œå‡å°‘äº† WASM åŒ…ä½“å¤§å°å’Œè¿è¡Œæ—¶ JS èƒ¶æ°´ä»£ç çš„è°ƒç”¨å¼€é”€ã€‚</p>
</li>
</ul>
<hr>
<h2 id="äº”ã€æ€»ç»“"><a href="#äº”ã€æ€»ç»“" class="headerlink" title="äº”ã€æ€»ç»“"></a>äº”ã€æ€»ç»“</h2><ul>
<li><strong>Animation</strong> æ˜¯ç›´è§‚çš„ã€çº¿æ€§çš„ã€ä¸»çº¿ç¨‹çš„ï¼Œèƒœåœ¨ç»“æ„ç®€å•ï¼Œé€‚åˆéè§’è‰²ç±»åŠ¨ç”»ã€‚</li>
<li><strong>Animator</strong> æ˜¯æŠ½è±¡çš„ã€å›¾é©±åŠ¨çš„ã€å¤šçº¿ç¨‹çš„ï¼Œèƒœåœ¨å¤ç”¨æ€§ä¸å¹¶è¡Œè®¡ç®—ï¼Œæ˜¯è§’è‰²åŠ¨ç”»çš„æ ‡å‡†è§£ã€‚</li>
<li><strong>ä¼˜åŒ–å…³é”®</strong>ï¼šåœ¨äºç†è§£â€œé‡å®šå‘â€çš„å¼€é”€ä»¥åŠæ­£ç¡®ä½¿ç”¨â€œCulling Modeâ€ã€‚åœ¨å›¢ç»“å¼•æ“ä¸­ï¼Œåˆ©ç”¨å…¶åŸç”Ÿçš„å®ä¾‹åŒ–ä¼˜åŒ–å’Œåˆ†çº§æ›´æ–°ç­–ç•¥ï¼Œå¯ä»¥è¿›ä¸€æ­¥æŒ–æ˜ç§»åŠ¨ç«¯çš„æ€§èƒ½æ½œåŠ›ã€‚</li>
</ul>
<h2 id="ä¸‰ã€æ·±åº¦åˆ†æï¼šä»-C-æ¥å£åˆ°-C-å†…æ ¸çš„æ‰§è¡Œæµæ¨å¯¼"><a href="#ä¸‰ã€æ·±åº¦åˆ†æï¼šä»-C-æ¥å£åˆ°-C-å†…æ ¸çš„æ‰§è¡Œæµæ¨å¯¼" class="headerlink" title="ä¸‰ã€æ·±åº¦åˆ†æï¼šä» C# æ¥å£åˆ° C++ å†…æ ¸çš„æ‰§è¡Œæµæ¨å¯¼"></a>ä¸‰ã€æ·±åº¦åˆ†æï¼šä» C# æ¥å£åˆ° C++ å†…æ ¸çš„æ‰§è¡Œæµæ¨å¯¼</h2><p>Unity çš„åŠ¨ç”»ç³»ç»Ÿåˆ†ä¸º C# æ¥å£å±‚ï¼ˆAPIï¼‰å’Œ C++ æ ¸å¿ƒå±‚ï¼ˆNativeï¼‰ã€‚æœ¬ç« å°†å‰¥ç¦» C# çš„ <code>extern</code> è°ƒç”¨ï¼Œé€šè¿‡é€†å‘æ¨å¯¼è¿˜åŸå…¶åº•å±‚çš„æ ¸å¿ƒå¾ªç¯é€»è¾‘ï¼Œæ­ç¤ºæ€§èƒ½å·®å¼‚çš„æ ¹æœ¬æ¥æºã€‚</p>
<h3 id="3-1-Animation-Legacy-çš„â€œå­—ç¬¦ä¸²åœ°ç‹±â€ä¸ä¸²è¡Œè®¡ç®—"><a href="#3-1-Animation-Legacy-çš„â€œå­—ç¬¦ä¸²åœ°ç‹±â€ä¸ä¸²è¡Œè®¡ç®—" class="headerlink" title="3.1 Animation (Legacy) çš„â€œå­—ç¬¦ä¸²åœ°ç‹±â€ä¸ä¸²è¡Œè®¡ç®—"></a>3.1 Animation (Legacy) çš„â€œå­—ç¬¦ä¸²åœ°ç‹±â€ä¸ä¸²è¡Œè®¡ç®—</h3><p><code>Animation</code> ç»„ä»¶ä¹‹æ‰€ä»¥è¢«æ ‡è®°ä¸º Legacy ä¸”æ€§èƒ½è¾ƒå·®ï¼Œæ ¸å¿ƒåŸå› åœ¨äºå…¶<strong>åŸºäºå­—ç¬¦ä¸²çš„åŠ¨æ€å¯»å€</strong>å’Œ<strong>éè¿ç»­å†…å­˜è®¿é—®</strong>ã€‚</p>
<h4 id="3-1-1-C-å±‚çš„å…¥å£"><a href="#3-1-1-C-å±‚çš„å…¥å£" class="headerlink" title="3.1.1 C# å±‚çš„å…¥å£"></a>3.1.1 C# å±‚çš„å…¥å£</h4><p>å½“æˆ‘ä»¬è°ƒç”¨ <code>animation.Play(&quot;Walk&quot;)</code> æ—¶ï¼ŒC# å±‚ä»…ä»…æ˜¯åšäº†ä¸€ä¸ªç®€å•çš„è½¬å‘ï¼š</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Unity C# Reference Source</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="built_in">bool</span> <span class="title">Play</span>(<span class="params"><span class="built_in">string</span> animation, PlayMode mode</span>)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> Internal_Play(animation, mode); <span class="comment">// è°ƒç”¨ C++ å†…éƒ¨æ¥å£</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="3-1-2-C-å†…æ ¸é€»è¾‘æ¨å¯¼-Pseudo-Code"><a href="#3-1-2-C-å†…æ ¸é€»è¾‘æ¨å¯¼-Pseudo-Code" class="headerlink" title="3.1.2 C++ å†…æ ¸é€»è¾‘æ¨å¯¼ (Pseudo-Code)"></a>3.1.2 C++ å†…æ ¸é€»è¾‘æ¨å¯¼ (Pseudo-Code)</h4><p>åœ¨ C++ å±‚ï¼Œ<code>Animation</code> çš„ Update å¾ªç¯å¤§è‡´å¦‚ä¸‹ã€‚è¯·æ³¨æ„å…¶<strong>ä¸¥é‡çš„ Cache Miss</strong> é£é™©ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ä¼ªä»£ç ï¼šè¿˜åŸ Legacy Animation çš„å•å¸§æ›´æ–°é€»è¾‘</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">AnimationComponent::Update</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">// 1. éå†æ‰€æœ‰æ¿€æ´»çŠ¶æ€ (Active States)</span></span><br><span class="line">    <span class="comment">// é—®é¢˜ï¼šè¿™æ˜¯ä¸€ä¸ªé“¾è¡¨æˆ–åŠ¨æ€æ•°ç»„ï¼Œå†…å­˜å¯èƒ½ä¸è¿ç»­</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">auto</span>&amp; state : m_ActiveStates) &#123;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 2. æ—¶é—´ç§¯åˆ†</span></span><br><span class="line">        state.normalizedTime += Time::deltaTime * state.speed;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 3. æ›²çº¿é‡‡æ · (Curve Sampling)</span></span><br><span class="line">        <span class="comment">// éå†è¯¥ Clip ä¸‹çš„æ‰€æœ‰æ›²çº¿ï¼ˆä¾‹å¦‚ï¼šåŒ…å« Position.x, Rotation.w ç­‰æ•°ç™¾æ¡ï¼‰</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">auto</span>&amp; curve : state.clip-&gt;m_Curves) &#123;</span><br><span class="line">            <span class="type">float</span> value = <span class="built_in">EvaluateHermite</span>(curve, state.normalizedTime);</span><br><span class="line">            </span><br><span class="line">            <span class="comment">// 4. ã€æ€§èƒ½æ€æ‰‹ã€‘å¯»å€ä¸åº”ç”¨ (Addressing &amp; Apply)</span></span><br><span class="line">            <span class="comment">// Legacy åŠ¨ç”»æ¯ä¸€å¸§éƒ½éœ€è¦é€šè¿‡â€œè·¯å¾„å­—ç¬¦ä¸²â€å»æŸ¥æ‰¾ Transform å¼•ç”¨</span></span><br><span class="line">            <span class="comment">// è™½ç„¶æœ‰ Cache æœºåˆ¶ï¼Œä½† Cache Miss ç‡ä¾ç„¶å¾ˆé«˜</span></span><br><span class="line">            Transform* target = <span class="built_in">FindTransformByPath</span>(<span class="keyword">this</span>-&gt;transform, curve.pathString);</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">if</span> (target) &#123;</span><br><span class="line">                <span class="comment">// ç›´æ¥å†™å…¥æ•°æ®ï¼Œå¯¼è‡´å¤§é‡çš„ä¸»çº¿ç¨‹ Dirty æ ‡è®°</span></span><br><span class="line">                <span class="comment">// è¿™ä¼šè§¦å‘ Transform ç³»ç»Ÿçš„å±‚çº§å˜æ›´é€šçŸ¥ (OnTransformChanged)</span></span><br><span class="line">                target-&gt;<span class="built_in">SetLocalValue</span>(curve.propertyName, value);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="3-1-3-æºç çº§æ€§èƒ½ç—›ç‚¹"><a href="#3-1-3-æºç çº§æ€§èƒ½ç—›ç‚¹" class="headerlink" title="3.1.3 æºç çº§æ€§èƒ½ç—›ç‚¹"></a>3.1.3 æºç çº§æ€§èƒ½ç—›ç‚¹</h4><ol>
<li><strong>å­—ç¬¦ä¸²å“ˆå¸Œç¢°æ’</strong>ï¼š<code>FindTransformByPath</code> ä¾èµ–è·¯å¾„å­—ç¬¦ä¸²çš„ Hash æŸ¥æ‰¾ã€‚å¦‚æœå±‚çº§å¾ˆæ·±ï¼ˆå¦‚ <code>Root/Hips/Spine/Chest/Neck/Head</code>ï¼‰ï¼Œæ¯ä¸€å¸§çš„å­—ç¬¦ä¸² Hash è®¡ç®—å’Œ Map æŸ¥æ‰¾å¼€é”€å·¨å¤§ã€‚</li>
<li><strong>æŒ‡ä»¤ç¼“å­˜å¤±æ•ˆ (I-Cache Miss)</strong>ï¼šç”±äºç›´æ¥ä¿®æ”¹ Transformï¼Œå¯¼è‡´ CPU åœ¨â€œè®¡ç®—æ’å€¼â€å’Œâ€œæ›´æ–°ä¸–ç•ŒçŸ©é˜µâ€ä¸¤ä¸ªæŒ‡ä»¤é›†ä¹‹é—´é¢‘ç¹åˆ‡æ¢ã€‚</li>
</ol>
<hr>
<h3 id="3-2-Animator-Mecanim-çš„-Job-System-ä¸-SIMD-ä¼˜åŒ–"><a href="#3-2-Animator-Mecanim-çš„-Job-System-ä¸-SIMD-ä¼˜åŒ–" class="headerlink" title="3.2 Animator (Mecanim) çš„ Job System ä¸ SIMD ä¼˜åŒ–"></a>3.2 Animator (Mecanim) çš„ Job System ä¸ SIMD ä¼˜åŒ–</h3><p><code>Animator</code> çš„åº•å±‚ä¸ä»…æ˜¯é€»è¾‘çš„æ”¹å˜ï¼Œæ›´æ˜¯**æ•°æ®å¸ƒå±€ï¼ˆData Layoutï¼‰**çš„é©å‘½ã€‚å®ƒå°†å¯¹è±¡å¼ç¼–ç¨‹ï¼ˆOOPï¼‰è½¬å˜ä¸ºé¢å‘æ•°æ®æŠ€æœ¯ï¼ˆDOTSï¼‰çš„å‰èº«ã€‚</p>
<h4 id="3-2-1-åˆå§‹åŒ–é˜¶æ®µçš„â€œç»‘å®šï¼ˆBindï¼‰â€"><a href="#3-2-1-åˆå§‹åŒ–é˜¶æ®µçš„â€œç»‘å®šï¼ˆBindï¼‰â€" class="headerlink" title="3.2.1 åˆå§‹åŒ–é˜¶æ®µçš„â€œç»‘å®šï¼ˆBindï¼‰â€"></a>3.2.1 åˆå§‹åŒ–é˜¶æ®µçš„â€œç»‘å®šï¼ˆBindï¼‰â€</h4><p>ä¸åŒäº Animation çš„æ¯å¸§æŸ¥æ‰¾ï¼ŒAnimator åœ¨ <code>Initialize</code> é˜¶æ®µå®Œæˆæ‰€æœ‰ç»‘å®šï¼š</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ä¼ªä»£ç ï¼šAnimator åˆå§‹åŒ–é€»è¾‘</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">Animator::Initialize</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">// 1. æ„å»ºéª¨éª¼æµ (Stream)</span></span><br><span class="line">    <span class="comment">// æ‰å¹³åŒ– Avatar çš„éª¨éª¼å±‚çº§ï¼Œå­˜å…¥è¿ç»­å†…å­˜ (NativeArray)</span></span><br><span class="line">    m_StreamBuffer = <span class="built_in">BuildStreamBuffer</span>(avatar);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 2. é¢„è®¡ç®—ç»‘å®šå¥æŸ„ (Bind Handles)</span></span><br><span class="line">    <span class="comment">// å°†çŠ¶æ€æœºä¸­ç”¨åˆ°çš„å±æ€§ç›´æ¥æ˜ å°„åˆ° Buffer çš„åç§»é‡ (Offset)</span></span><br><span class="line">    <span class="comment">// è¿è¡Œæ—¶ä¸å†éœ€è¦å­—ç¬¦ä¸²ï¼Œåªæœ‰ int ç´¢å¼•</span></span><br><span class="line">    <span class="built_in">ResolvePropertyBindings</span>(controller, m_StreamBuffer);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="3-2-2-C-æ›´æ–°å¾ªç¯ï¼šå¤šçº¿ç¨‹ä¸-SIMD"><a href="#3-2-2-C-æ›´æ–°å¾ªç¯ï¼šå¤šçº¿ç¨‹ä¸-SIMD" class="headerlink" title="3.2.2 C++ æ›´æ–°å¾ªç¯ï¼šå¤šçº¿ç¨‹ä¸ SIMD"></a>3.2.2 C++ æ›´æ–°å¾ªç¯ï¼šå¤šçº¿ç¨‹ä¸ SIMD</h4><p>Animator çš„ Update è¢«æ‹†åˆ†ä¸ºå¤šä¸ª Jobï¼Œç”± Unity çš„ Job System è°ƒåº¦ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ä¼ªä»£ç ï¼šAnimator çš„å¹¶è¡Œæµæ°´çº¿</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">AnimatorSystem::ExecuteFrame</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// Phase 1: é€»è¾‘è¯„ä¼° (Main Thread / Worker Thread)</span></span><br><span class="line">    <span class="comment">// è®¡ç®—çŠ¶æ€æœºè·³è½¬ï¼Œç”Ÿæˆâ€œæ··åˆä»»åŠ¡ (BlendGraph)â€</span></span><br><span class="line">    <span class="comment">// äº§å‡ºï¼šä¸€ä»½æè¿°â€œå“ªäº› Clip éœ€è¦æ’­æ”¾ï¼Œæƒé‡å¤šå°‘â€çš„æ•°æ®ç»“æ„</span></span><br><span class="line">    <span class="built_in">Job_EvaluateStateMachine</span>(inputs, &amp;blendGraph);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// Phase 2: é‡‡æ ·ä¸æ··åˆ (Worker Threads, Parallel)</span></span><br><span class="line">    <span class="comment">// å¤šä¸ª Animator å¯ä»¥å¹¶è¡Œæ‰§è¡Œæ­¤æ­¥éª¤</span></span><br><span class="line">    <span class="built_in">ParallelFor</span>(allAnimators, [](<span class="type">int</span> index) &#123;</span><br><span class="line">        <span class="keyword">auto</span>&amp; animator = allAnimators[index];</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// è¯»å–å‹ç¼©çš„ Clip æ•°æ®ï¼Œåˆ©ç”¨ SIMD æŒ‡ä»¤åŒæ—¶è®¡ç®— 4 ä¸ª float (x,y,z,w)</span></span><br><span class="line">        <span class="comment">// ç»“æœä¸ç›´æ¥å†™ Transformï¼Œè€Œæ˜¯å†™å…¥ä¸´æ—¶çš„ StreamBuffer</span></span><br><span class="line">        <span class="built_in">SIMD_SampleAndBlend</span>(animator.blendGraph, animator.streamBuffer);</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Phase 3: é‡å®šå‘ (Retargeting) (Worker Threads)</span></span><br><span class="line">    <span class="comment">// å°† Humanoid éª¨éª¼æ•°æ®æ˜ å°„åˆ°å…·ä½“çš„ Avatar éª¨éª¼</span></span><br><span class="line">    <span class="comment">// çº¯æ•°å­¦è®¡ç®—ï¼Œæåº¦ä¾èµ– CPU ç®—åŠ›</span></span><br><span class="line">    <span class="built_in">ParallelFor</span>(allAnimators, [](<span class="type">int</span> index) &#123;</span><br><span class="line">        <span class="built_in">RetargetHumanoid</span>(allAnimators[index].streamBuffer);</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Phase 4: å›å†™ (Write Transform) (Main Thread or Job)</span></span><br><span class="line">    <span class="comment">// åªæœ‰åœ¨æœ€åï¼Œæ‰å°† StreamBuffer çš„æ•°æ®æ‰¹é‡å†™å…¥ Transform ç»„ä»¶</span></span><br><span class="line">    <span class="comment">// å¦‚æœå¼€å¯äº† &quot;CullUpdateTransforms&quot;ï¼Œè¿™ä¸€æ­¥ä¼šè¢«ç›´æ¥è·³è¿‡ï¼</span></span><br><span class="line">    <span class="keyword">if</span> (animator.isVisible) &#123;</span><br><span class="line">        <span class="built_in">WriteBufferToTransforms</span>(animator.streamBuffer);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="3-2-3-æºç çº§ä¼˜åŠ¿åˆ†æ"><a href="#3-2-3-æºç çº§ä¼˜åŠ¿åˆ†æ" class="headerlink" title="3.2.3 æºç çº§ä¼˜åŠ¿åˆ†æ"></a>3.2.3 æºç çº§ä¼˜åŠ¿åˆ†æ</h4><ol>
<li><strong>æ— é”å¹¶è¡Œ</strong>ï¼šç”±äº Phase 2 å’Œ Phase 3 æ˜¯åœ¨ç‹¬ç«‹çš„ Buffer ä¸Šæ“ä½œï¼Œä¸è§¦ç¢° Unity APIï¼ˆå³ä¸è§¦ç¢° Transformï¼‰ï¼Œå› æ­¤å¯ä»¥å®‰å…¨åœ°åˆ†é…åˆ°å¤šä¸ª Worker çº¿ç¨‹å¹¶è¡Œå¤„ç†ã€‚</li>
<li><strong>ç¼“å­˜å‘½ä¸­ç‡æé«˜</strong>ï¼š<code>m_StreamBuffer</code> æ˜¯è¿ç»­å†…å­˜ï¼ŒCPU é¢„å–å™¨ï¼ˆPrefetcherï¼‰å¯ä»¥é«˜æ•ˆå·¥ä½œï¼Œæå¤§å‡å°‘ D-Cache Missã€‚</li>
<li><strong>SIMD æŒ‡ä»¤é›†</strong>ï¼šæ’å€¼è®¡ç®—ï¼ˆLerp&#x2F;Slerpï¼‰å¤§é‡ä½¿ç”¨äº† SSE&#x2F;NEON æŒ‡ä»¤é›†ï¼Œå•æ¬¡æŒ‡ä»¤å¤„ç†æ›´å¤šæ•°æ®ã€‚</li>
</ol>
<hr>
<h2 id="å››ã€ç»„ä»¶åº•å±‚å·®å¼‚å¯¹æ¯”ï¼ˆä¿®æ­£ç‰ˆï¼‰"><a href="#å››ã€ç»„ä»¶åº•å±‚å·®å¼‚å¯¹æ¯”ï¼ˆä¿®æ­£ç‰ˆï¼‰" class="headerlink" title="å››ã€ç»„ä»¶åº•å±‚å·®å¼‚å¯¹æ¯”ï¼ˆä¿®æ­£ç‰ˆï¼‰"></a>å››ã€ç»„ä»¶åº•å±‚å·®å¼‚å¯¹æ¯”ï¼ˆä¿®æ­£ç‰ˆï¼‰</h2><p>ï¼ˆâ€¦ä¿æŒåŸè¡¨æ ¼ï¼Œå¢åŠ ä¸€è¡Œâ€œåº•å±‚å¼€é”€åˆ†æâ€â€¦ï¼‰</p>
<table>
<thead>
<tr>
<th align="left">ç»´åº¦</th>
<th align="left">Animation (Legacy)</th>
<th align="left">Animator (Modern)</th>
</tr>
</thead>
<tbody><tr>
<td align="left"><strong>åº•å±‚å¼€é”€æ ¸å¿ƒ</strong></td>
<td align="left"><strong>å­—ç¬¦ä¸² Hash ä¸ Map æŸ¥æ‰¾</strong><br>æ¯å¸§ã€æ¯ä¸ªæ›²çº¿éƒ½åœ¨æŸ¥è¡¨ã€‚</td>
<td align="left"><strong>é‡å®šå‘çŸ©é˜µä¹˜æ³• (Matrix Mul)</strong><br>æ•°å­¦è®¡ç®—é‡ï¼Œä½†å†…å­˜è®¿é—®æå¿«ã€‚</td>
</tr>
<tr>
<td align="left"><strong>å¤šçº¿ç¨‹æ”¯æŒ</strong></td>
<td align="left"><strong>æ— </strong><br>å¿…é¡»åœ¨ä¸»çº¿ç¨‹æ“ä½œ Transformã€‚</td>
<td align="left"><strong>åŸç”Ÿæ”¯æŒ</strong><br>è®¡ç®—ä¸åº”ç”¨åˆ†ç¦»ï¼Œå®Œç¾å¥‘åˆ Job Systemã€‚</td>
</tr>
</tbody></table>
<hr>
<h2 id="äº”ã€å›¢ç»“å¼•æ“-Tuanjie-çš„å…¬å¼€ä¼˜åŒ–ï¼šåŸºäºæºç çš„é­”æ”¹"><a href="#äº”ã€å›¢ç»“å¼•æ“-Tuanjie-çš„å…¬å¼€ä¼˜åŒ–ï¼šåŸºäºæºç çš„é­”æ”¹" class="headerlink" title="äº”ã€å›¢ç»“å¼•æ“ (Tuanjie) çš„å…¬å¼€ä¼˜åŒ–ï¼šåŸºäºæºç çš„é­”æ”¹"></a>äº”ã€å›¢ç»“å¼•æ“ (Tuanjie) çš„å…¬å¼€ä¼˜åŒ–ï¼šåŸºäºæºç çš„é­”æ”¹</h2><p>å›¢ç»“å¼•æ“ä¹‹æ‰€ä»¥èƒ½ä¼˜åŒ–ï¼Œæ˜¯å› ä¸ºå®ƒå¯ä»¥ç›´æ¥ä¿®æ”¹ä¸Šè¿°çš„ C++ å†…æ ¸ä»£ç ã€‚</p>
<h3 id="5-1-å…±äº«å¸¸é‡ç¼“å†²-Constant-Buffer-Sharing"><a href="#5-1-å…±äº«å¸¸é‡ç¼“å†²-Constant-Buffer-Sharing" class="headerlink" title="5.1 å…±äº«å¸¸é‡ç¼“å†² (Constant Buffer Sharing)"></a>5.1 å…±äº«å¸¸é‡ç¼“å†² (Constant Buffer Sharing)</h3><p>åœ¨åŸç‰ˆ Unity ä¸­ï¼Œæ¯ä¸ª <code>Animator</code> å®ä¾‹éƒ½æœ‰ç‹¬ç«‹çš„ <code>RuntimeController</code> æ•°æ®å‰¯æœ¬ã€‚</p>
<ul>
<li><strong>Tuanjie æºç çº§æ”¹åŠ¨</strong>ï¼š<br>  å°† <code>RuntimeController</code> ä¸­çš„åªè¯»æ•°æ®ï¼ˆå¦‚çŠ¶æ€æœºæ‹“æ‰‘ç»“æ„ã€Clip å¼•ç”¨ã€Transition æ¡ä»¶ï¼‰æå–ä¸º<strong>å…¨å±€å•ä¾‹</strong>ã€‚  <figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Tuanjie ä¼˜åŒ–åçš„å†…å­˜å¸ƒå±€</span></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">AnimatorInstance</span> &#123;</span><br><span class="line">    SharedControllerData* staticData; <span class="comment">// 1000ä¸ªå®ä¾‹æŒ‡å‘åŒä¸€ä¸ªæŒ‡é’ˆ</span></span><br><span class="line">    InstanceData dynamicData;         <span class="comment">// ä»…å­˜å‚¨å½“å‰ State ID å’Œ Time</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
  è¿™è§£é‡Šäº†ä¸ºä»€ä¹ˆåœ¨ç”Ÿæˆå¤§é‡ AI æ—¶ï¼Œå†…å­˜å ç”¨èƒ½ä¸‹é™ 20%ã€‚</li>
</ul>
<h3 id="5-2-æ™ºèƒ½çš„-Update-é™é¢‘"><a href="#5-2-æ™ºèƒ½çš„-Update-é™é¢‘" class="headerlink" title="5.2 æ™ºèƒ½çš„ Update é™é¢‘"></a>5.2 æ™ºèƒ½çš„ Update é™é¢‘</h3><p>Tuanjie åœ¨ C++ å±‚æ‹¦æˆªäº† <code>Phase 4: WriteBufferToTransforms</code>ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Tuanjie ä¼ªä»£ç ï¼šå„å‘å¼‚æ€§æ›´æ–°</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">WriteBufferToTransforms</span><span class="params">(...)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (isLowEndDevice &amp;&amp; distance &gt; <span class="number">20.0f</span>) &#123;</span><br><span class="line">        <span class="comment">// å¼ºåˆ¶é™é¢‘ï¼šæ¯ 4 å¸§æ‰å†™ä¸€æ¬¡ Transform</span></span><br><span class="line">        <span class="comment">// ä½†ä¸ºäº†å¹³æ»‘ï¼Œå¯èƒ½ä¼šåœ¨ Shader å±‚åšç®€å•çš„æ’å€¼</span></span><br><span class="line">        <span class="keyword">if</span> (frameCount % <span class="number">4</span> != <span class="number">0</span>) <span class="keyword">return</span>; </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// ... åŸæœ‰é€»è¾‘</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="å…­ã€æ€»ç»“ä¸å»ºè®®"><a href="#å…­ã€æ€»ç»“ä¸å»ºè®®" class="headerlink" title="å…­ã€æ€»ç»“ä¸å»ºè®®"></a>å…­ã€æ€»ç»“ä¸å»ºè®®</h2><p>é€šè¿‡æºç çº§åˆ†æï¼Œæˆ‘ä»¬å¯ä»¥å¾—å‡ºæ›´å…·æŒ‡å¯¼æ„ä¹‰çš„ç»“è®ºï¼š</p>
<ol>
<li><strong>é¿å…åœ¨ Animation ä¸­ä½¿ç”¨æ·±å±‚çº§è·¯å¾„</strong>ï¼šå¦‚æœå¿…é¡»ç”¨ Legacy Animationï¼Œè¯·å°½é‡è®©åŠ¨ç”»æ ¹èŠ‚ç‚¹é è¿‘ Mesh èŠ‚ç‚¹ï¼Œå‡å°‘ <code>FindTransform</code> çš„æ·±åº¦ã€‚</li>
<li><strong>Animator çš„æ€§èƒ½ç“¶é¢ˆæ˜¯æ•°å­¦</strong>ï¼šå¦‚æœåœ¨ Profile ä¸­çœ‹åˆ° <code>Animator.Update</code> è€—æ—¶é«˜ï¼Œé€šå¸¸æ˜¯å› ä¸ºéª¨éª¼æ•°é‡å¤ªå¤šå¯¼è‡´çš„é‡å®šå‘è®¡ç®—é‡å¤§ã€‚è§£å†³æ–¹æ³•æ˜¯å‡å°‘éª¨éª¼æ•°ï¼Œæˆ–ä½¿ç”¨ <code>Optimize Game Objects</code> é€‰é¡¹ï¼ˆè¯¥é€‰é¡¹ä¼šç§»é™¤ Transform ç»„ä»¶ï¼Œç›´æ¥åœ¨ C++ å±‚å¤„ç†çŸ©é˜µï¼Œæå¤§æå‡ Phase 4 çš„æ•ˆç‡ï¼‰ã€‚</li>
<li><strong>ç†è§£ Write Transform çš„ä»£ä»·</strong>ï¼šè¿™å°±æ˜¯ä¸ºä»€ä¹ˆ <code>CullUpdateTransforms</code> å¦‚æ­¤é‡è¦â€”â€”å®ƒç›´æ¥åˆ‡æ–­äº† Phase 4 çš„æ‰§è¡Œï¼Œè€Œè¿™ä¸€æ­¥é€šå¸¸å æ®äº†å•å¸§ 30% ä»¥ä¸Šçš„åŠ¨ç”»å¼€é”€ã€‚</li>
</ol>
</div><!-- åˆå§‹åŒ–AIæ‘˜è¦--><!-- å¯†ç ä¿æŠ¤è„šæœ¬--><script>document.addEventListener('DOMContentLoaded', function() {
  var passwordProtect = document.querySelector('.password-protect');
  if (!passwordProtect) return;

  var password = passwordProtect.dataset.password;
  var overlay = document.querySelector('.password-overlay');
  var input = document.querySelector('.password-input');
  var submit = document.querySelector('.password-submit');
  var error = document.querySelector('.password-error');

  // é…ç½®ï¼šå¯†ç æœ‰æ•ˆæœŸï¼ˆæ¯«ç§’ï¼‰
  // 24å°æ—¶ = 24 * 60 * 60 * 1000 = 86400000
  // 7å¤© = 7 * 24 * 60 * 60 * 1000 = 604800000
  var EXPIRY_TIME = 60 * 60 * 1000; // 1å°æ—¶

  // éœ€è¦éšè—çš„å…ƒç´ åˆ—è¡¨
  var elementsToHide = [
    '.toc-sidebar',           // ç›®å½•
    '.post-header',           // æ–‡ç« å¤´éƒ¨ï¼ˆå°é¢ã€æ ‡é¢˜ã€æ ‡ç­¾ç­‰ï¼‰
    '.post-content',          // æ–‡ç« å†…å®¹
    '.post-navigation',       // ä¸Šä¸€ç¯‡/ä¸‹ä¸€ç¯‡
    '.post-share'             // åˆ†äº«æŒ‰é’®
  ];

  // éšè—æ‰€æœ‰ç›¸å…³å…ƒç´ 
  function hideAllElements() {
    elementsToHide.forEach(function(selector) {
      var element = document.querySelector(selector);
      if (element) {
        element.style.display = 'none';
      }
    });
  }

  // æ˜¾ç¤ºæ‰€æœ‰ç›¸å…³å…ƒç´ 
  function showAllElements() {
    elementsToHide.forEach(function(selector) {
      var element = document.querySelector(selector);
      if (element) {
        element.style.display = '';
      }
    });
  }

  // åˆå§‹éšè—æ‰€æœ‰å…ƒç´ 
  hideAllElements();

  // è§£é”å‡½æ•°
  function unlock() {
    if (input.value === password) {
      overlay.style.display = 'none';
      showAllElements();

      // å­˜å‚¨è§£é”çŠ¶æ€å’Œæ—¶é—´æˆ³
      var unlockData = {
        unlocked: true,
        timestamp: Date.now()
      };
      localStorage.setItem('unlocked-' + window.location.pathname, JSON.stringify(unlockData));
    } else {
      error.textContent = 'å¯†ç é”™è¯¯ï¼Œè¯·é‡è¯•ï¼';
      error.style.display = 'block';
      input.value = '';
      input.focus();
    }
  }

  // æ£€æŸ¥æ˜¯å¦å·²ç»è§£é”ï¼ˆè®°ä½å¯†ç ï¼‰
  var unlockData = localStorage.getItem('unlocked-' + window.location.pathname);
  if (unlockData) {
    try {
      var data = JSON.parse(unlockData);
      var now = Date.now();

      // æ£€æŸ¥æ˜¯å¦è¿‡æœŸ
      if (data.unlocked && (now - data.timestamp) < EXPIRY_TIME) {
        // æœªè¿‡æœŸï¼Œç›´æ¥æ˜¾ç¤ºæ‰€æœ‰å…ƒç´ 
        overlay.style.display = 'none';
        showAllElements();
      } else {
        // å·²è¿‡æœŸï¼Œæ¸…é™¤å­˜å‚¨çš„æ•°æ®
        localStorage.removeItem('unlocked-' + window.location.pathname);
      }
    } catch (e) {
      // å¦‚æœè§£æå¤±è´¥ï¼Œæ¸…é™¤æ•°æ®
      localStorage.removeItem('unlocked-' + window.location.pathname);
    }
  }

  // ç»‘å®šäº‹ä»¶
  submit.addEventListener('click', unlock);
  input.addEventListener('keypress', function(e) {
    if (e.key === 'Enter') unlock();
  });
});
</script><!-- å¯†ç ä¿æŠ¤æ ·å¼--><style>.password-protect {
  position: relative;
}

.password-overlay {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: rgba(255, 255, 255, 0.95);
  backdrop-filter: blur(10px);
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 9999;
}

.password-box {
  background: white;
  padding: 40px;
  border-radius: 15px;
  box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
  text-align: center;
  max-width: 400px;
  width: 90%;
}

.password-box h3 {
  margin-top: 0;
  color: #333;
  font-size: 1.5rem;
}

.password-box p {
  color: #666;
  margin-bottom: 20px;
}

.password-input {
  width: 100%;
  padding: 12px 15px;
  border: 2px solid #e0e0e0;
  border-radius: 8px;
  font-size: 16px;
  margin-bottom: 15px;
  transition: border-color 0.3s;
}

.password-input:focus {
  outline: none;
  border-color: #ff6b6b;
}

.password-submit {
  background: #ff6b6b;
  color: white;
  border: none;
  padding: 12px 30px;
  border-radius: 8px;
  font-size: 16px;
  cursor: pointer;
  transition: background 0.3s;
}

.password-submit:hover {
  background: #ff5252;
}

.post-content {
  transition: opacity 0.5s ease;
}</style><script>document.addEventListener('DOMContentLoaded', function() {
  if (typeof ChucklePostAI !== 'undefined') {
    // è·å–æŒ‰é’®æ–‡æœ¬ï¼Œå¦‚æœæœªå®šä¹‰åˆ™ä½¿ç”¨é»˜è®¤å€¼
    const buttons = [
      "ä»‹ç»è‡ªå·±",
      "æ¥ç‚¹çµæ„Ÿ",
      "ç”ŸæˆAIç®€ä»‹"
    ];

    new ChucklePostAI({
      el: '#post-ai-container',
      title_el: '.post-title',
      summary_directly: false,
      interface: {
        name: "Timing-AI",
        introduce: "æœ‰äº‹æ²¡äº‹ç‚¹ç‚¹çœ‹å§ï¼Œä¸ºæ‚¨æœåŠ¡ğŸ˜Š",
        version: "SiliconFlow",
        button: buttons
      }
    });
  }
});
</script><!-- ä¼ é€’TOCé…ç½®ç»™å‰ç«¯--><script>// åˆ›å»ºå…¨å±€TOCé…ç½®å¯¹è±¡
window.tocConfig = {
  empty_toc_behavior: "placeholder"
};
</script><div class="post-navigation"><div class="post-nav prev"><a href="/2026/01/21/%E6%9B%B2%E7%BA%BF%E5%B1%9E%E6%80%A7%E5%88%86%E6%9E%90/"><span class="nav-label">â† Previous</span><span class="nav-title">æ›²çº¿å±æ€§åˆ†æ</span></a></div><div class="post-nav next"><a href="/2025/12/31/%E7%BB%BC%E8%BF%B0%EF%BC%9AUnity%E5%8A%A8%E7%94%BB%E7%B3%BB%E7%BB%9F%E5%BA%95%E5%B1%82%E6%9E%B6%E6%9E%84%E6%80%BB%E8%A7%88/"><span class="nav-label">Next â†’</span><span class="nav-title">ç»¼è¿°ï¼šUnityåŠ¨ç”»ç³»ç»Ÿåº•å±‚æ¶æ„æ€»è§ˆ</span></a></div></div><div class="post-share"><h3 class="share-title">Share this article</h3><div class="share-buttons"><a class="share-btn twitter" href="https://twitter.com/intent/tweet?text=Animator%E4%B8%8EAnimation%E5%BA%95%E5%B1%82%E5%AE%9E%E7%8E%B0%E5%89%96%E6%9E%90&amp;url=%2F2026%2F01%2F09%2FAnimator%25E4%25B8%258EAnimation%25E5%25BA%2595%25E5%25B1%2582%25E5%25AE%259E%25E7%258E%25B0%25E5%2589%2596%25E6%259E%2590%2F" target="_blank" rel="noopener"><span>Twitter</span></a><a class="share-btn facebook" href="https://www.facebook.com/sharer/sharer.php?u=%2F2026%2F01%2F09%2FAnimator%25E4%25B8%258EAnimation%25E5%25BA%2595%25E5%25B1%2582%25E5%25AE%259E%25E7%258E%25B0%25E5%2589%2596%25E6%259E%2590%2F" target="_blank" rel="noopener"><span>Facebook</span></a><a class="share-btn linkedin" href="https://www.linkedin.com/sharing/share-offsite/?url=%2F2026%2F01%2F09%2FAnimator%25E4%25B8%258EAnimation%25E5%25BA%2595%25E5%25B1%2582%25E5%25AE%259E%25E7%258E%25B0%25E5%2589%2596%25E6%259E%2590%2F" target="_blank" rel="noopener"><span>LinkedIn</span></a><a class="share-btn wechat" href="#" data-wechat="/2026/01/09/Animator%E4%B8%8EAnimation%E5%BA%95%E5%B1%82%E5%AE%9E%E7%8E%B0%E5%89%96%E6%9E%90/"><span>å¾®ä¿¡</span></a><a class="share-btn qq" href="https://connect.qq.com/widget/shareqq/index.html?url=%2F2026%2F01%2F09%2FAnimator%25E4%25B8%258EAnimation%25E5%25BA%2595%25E5%25B1%2582%25E5%25AE%259E%25E7%258E%25B0%25E5%2589%2596%25E6%259E%2590%2F&amp;title=Animator%E4%B8%8EAnimation%E5%BA%95%E5%B1%82%E5%AE%9E%E7%8E%B0%E5%89%96%E6%9E%90" target="_blank" rel="noopener"><span>QQ</span></a><a class="share-btn weibo" href="https://service.weibo.com/share/share.php?url=%2F2026%2F01%2F09%2FAnimator%25E4%25B8%258EAnimation%25E5%25BA%2595%25E5%25B1%2582%25E5%25AE%259E%25E7%258E%25B0%25E5%2589%2596%25E6%259E%2590%2F&amp;title=Animator%E4%B8%8EAnimation%E5%BA%95%E5%B1%82%E5%AE%9E%E7%8E%B0%E5%89%96%E6%9E%90" target="_blank" rel="noopener"><span>å¾®åš</span></a><a class="share-btn copy" href="#" data-copy="/2026/01/09/Animator%E4%B8%8EAnimation%E5%BA%95%E5%B1%82%E5%AE%9E%E7%8E%B0%E5%89%96%E6%9E%90/"><span>Copy Link</span></a></div></div></article></div><!-- æ·»åŠ èƒŒæ™¯å›¾æ”¯æŒ--></main><footer class="footer"><div class="footer-bottom"><div class="footer-copyright"><p>Â© 2026 Between's Blog</p></div><!-- Footer centered image with link--></div></footer></div><!-- ç«‹å³åº”ç”¨æš—è‰²æ¨¡å¼ï¼Œé¿å…é¡µé¢é—ªçƒ--><script>(function() {
  // æ£€æŸ¥æœ¬åœ°å­˜å‚¨ä¸­çš„æš—è‰²æ¨¡å¼è®¾ç½®
  const savedDarkMode = localStorage.getItem('darkMode') === 'true';
  // å¦‚æœè®¾ç½®ä¸ºæš—è‰²æ¨¡å¼ï¼Œç«‹å³åº”ç”¨åˆ°body
  if (savedDarkMode) {
    document.body.classList.add('dark-mode');
  }

  // é˜²æ­¢é¡µé¢é—ªçƒï¼Œåœ¨DOMåŠ è½½å®Œæˆå‰è®¾ç½®ä¸€ä¸ªåˆå§‹ç±»
  document.documentElement.style.visibility = 'hidden';
  document.addEventListener('DOMContentLoaded', function() {
    document.documentElement.style.visibility = 'visible';
  });
})();
</script>
<script src="/js/main.js"></script>

<script src="/js/tags.js"></script>

<script src="/js/categories-accordion.js"></script>

<script src="/js/highlight.js"></script>

<script src="/js/load-more.js"></script>

<script src="/js/header-scroll.js"></script>

<script src="/js/toc.js"></script>

<script src="/js/image-zoom.js"></script>

<script src="/js/share.js"></script>

<script src="/js/search.js"></script>

<script src="/js/hide-inline-interaction.js"></script>

<script src="/js/hide-toggle-interaction.js"></script>

<script src="/js/dark-mode-sync.js"></script>

<script src="/js/animations.js"></script>

<script src="/js/ai-theme.js"></script>

<script src="/js/loading-animation.js"></script>
<script>window.theme = {
  features: JSON.stringify(theme.features),
  code_block: JSON.stringify(theme.code_block),
  code_mermaid_fold: JSON.stringify(theme.code_mermaid_fold),
  ai_summary: JSON.stringify(theme.ai_summary),
  categories: JSON.stringify(theme.categories)
};
</script><script src="https://cdn.jsdelivr.net/npm/mermaid@10.6.1/dist/mermaid.min.js"></script><script>document.addEventListener('DOMContentLoaded', function() {
  if (window.mermaid) {
    var mermaidOptions = JSON.stringify(theme.mermaid.options || {});
    mermaid.initialize({
      startOnLoad: true,
      theme: theme.mermaid.theme || "default",
      flowchart: {
        useMaxWidth: true,
        htmlLabels: true,
        curve: 'basis'
      },
      ...mermaidOptions
    });
  }
});
</script><!-- åœ¨ Mermaid åˆå§‹åŒ–ååŠ è½½æŠ˜å åŠŸèƒ½-->
<script src="/js/code-mermaid-fold.js"></script>
<!-- åŠ è½½ Mermaid æ”¾å¤§é•œåŠŸèƒ½-->
<script src="/js/mermaid-magnifier.js"></script>
<script src="https://cdn.jsdelivr.net/npm/marked@9.1.6/marked.min.js"></script><script>document.addEventListener('DOMContentLoaded', function() {
  // é…ç½® marked.js
  if (window.marked) {
    marked.setOptions({
      breaks: true,  // æ”¯æŒæ¢è¡Œç¬¦
      gfm: true,     // GitHub é£æ ¼ Markdown
      highlight: function(code, lang) {
        // å¦‚æœæœ‰ä»£ç é«˜äº®åº“ï¼Œå¯ä»¥åœ¨è¿™é‡Œé›†æˆ
        return code;
      }
    });
  }
});
</script><script src="/js/ai.js"></script><script src="/js/postai.js"></script></body></html>